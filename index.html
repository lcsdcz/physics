<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>高中物理可视化教学助手 - 力学模拟</title>
    <link rel="stylesheet" href="./styles.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  </head>
  <body>
    <header class="app-header">
      <div class="brand">
        <div class="logo" id="brand-logo">F=ma</div>
        <div class="title">
          高中物理可视化教学助手
          <span class="subtitle">力学：速度 / 加速度 / 重力 / 弹力</span>
        </div>
      </div>
      <div class="actions">
        <button id="btn-play" class="primary">开始</button>
        <button id="btn-pause">暂停</button>
        <button id="btn-step">单步</button>
        <button id="btn-reset" class="danger">重置</button>
        <button id="btn-view-reset">复位视角</button>
      </div>
    </header>

    <main class="layout">
      <section class="left">
        <div class="canvas-wrap">
          <canvas id="sim-canvas" width="900" height="520"></canvas>
          <div class="overlay">
            <div class="legend">
              <span class="chip vel">速度 v</span>
              <span class="chip acc">加速度 a</span>
              <span class="chip grav">重力</span>
              <span class="chip spring">弹力</span>
              <span class="chip drag">阻力</span>
            </div>
            <div id="selection-info" class="sel-info" style="display:none"></div>
            <div class="formula-display" id="formula-display">
              <div class="formula-title">当前公式</div>
              <div id="current-formula">F = m·a</div>
              <div class="formula-description" id="formula-description">牛顿第二定律：力等于质量乘以加速度</div>
            </div>
          </div>
        </div>
        <div class="charts">
          <div class="chart">
            <div class="chart-title">速度大小 | v(t)</div>
            <canvas id="chart-speed" width="450" height="160"></canvas>
          </div>
          <div class="chart">
            <div class="chart-title">加速度大小 | a(t)</div>
            <canvas id="chart-acc" width="450" height="160"></canvas>
          </div>
        </div>
      </section>

      <aside class="right">
        <div class="panel">
          <div class="panel-title">
            <i class="fas fa-cube"></i>
            <span>场景</span>
            <div class="preset-selector" style="margin-left: auto;">
              <select id="preset-select" class="preset-select">
                <option value="">选择预设...</option>
                <!-- Presets will be loaded here -->
              </select>
              <button id="save-preset" class="btn-small" title="保存当前设置为预设"><i class="fas fa-save"></i></button>
            </div>
          </div>
          <label class="row">
            <span>选择场景</span>
            <select id="scenario">
              <option value="projectile">抛体运动（含空气阻力）</option>
              <option value="freefall">自由落体</option>
              <option value="spring">水平弹簧振子</option>
              <option value="force">力的合成与分解</option>
              <option value="uniform">匀速直线运动</option>
              <option value="uniform-accel">匀加速直线运动</option>
              <option value="circular">匀速圆周运动</option>
              <option value="inclined">斜面运动</option>
              <option value="pendulum">单摆运动</option>
              <option value="wave">机械波</option>
              <option value="collision-1d">一维碰撞（弹性/非弹性）</option>
              <option value="lever">杠杆平衡（力矩）</option>
              <option value="electric-field">匀强电场中的运动</option>
              <option value="magnetic-field">匀强磁场中的运动</option>
              <option value="em-field">电磁场组合运动</option>
            </select>
          </label>
          <label class="row" data-scope="force">
            <span>力1 F₁ (N)</span>
            <input type="range" id="fcomp-f1" min="0" max="100" step="1" value="30" />
            <output id="fcomp-f1-val">30</output>
          </label>
          <label class="row" data-scope="force">
            <span>角度 θ₁ (°)</span>
            <input type="range" id="fcomp-a1" min="-180" max="180" step="1" value="0" />
            <output id="fcomp-a1-val">0</output>
          </label>
          <label class="row" data-scope="force">
            <span>力2 F₂ (N)</span>
            <input type="range" id="fcomp-f2" min="0" max="100" step="1" value="20" />
            <output id="fcomp-f2-val">20</output>
          </label>
          <label class="row" data-scope="force">
            <span>角度 θ₂ (°)</span>
            <input type="range" id="fcomp-a2" min="-180" max="180" step="1" value="90" />
            <output id="fcomp-a2-val">90</output>
          </label>
        </div>

        <div class="panel">
          <div class="panel-title">
            <i class="fas fa-sliders-h"></i>
            <span>初始条件</span>
          </div>
          <label class="row">
            <span>质量 m (kg)</span>
            <input type="range" id="mass" min="0.1" max="10" step="0.1" value="1" />
            <input type="number" id="mass-num" min="0.1" max="10" step="0.1" value="1" />
          </label>
          <label class="row" data-scope="projectile">
            <span>初速度 v₀ (m/s)</span>
            <input type="range" id="v0" min="0" max="50" step="1" value="20" />
            <input type="number" id="v0-num" min="0" max="50" step="1" value="20" />
          </label>
          <label class="row" data-scope="projectile">
            <span>发射角 θ (°)</span>
            <input type="range" id="angle" min="0" max="90" step="1" value="45" />
            <input type="number" id="angle-num" min="0" max="90" step="1" value="45" />
          </label>
          <label class="row" data-scope="spring">
            <span>弹簧刚度 k (N/m)</span>
            <input type="range" id="spring-k" min="5" max="200" step="1" value="50" />
            <input type="number" id="spring-k-num" min="5" max="200" step="1" value="50" />
          </label>
          <label class="row" data-scope="spring">
            <span>阻尼 b (kg/s)</span>
            <input type="range" id="damping-b" min="0" max="5" step="0.1" value="0.5" />
            <input type="number" id="damping-b-num" min="0" max="5" step="0.1" value="0.5" />
          </label>
          <label class="row" data-scope="uniform">
            <span>速度 u (m/s)</span>
            <input type="range" id="uniform-u" min="0" max="20" step="0.5" value="5" />
            <input type="number" id="uniform-u-num" min="0" max="20" step="0.5" value="5" />
          </label>
          <label class="row" data-scope="uniform-accel">
            <span>初速度 u₀ (m/s)</span>
            <input type="range" id="ua-u0" min="-10" max="10" step="0.5" value="0" />
            <input type="number" id="ua-u0-num" min="-10" max="10" step="0.5" value="0" />
          </label>
          <label class="row" data-scope="uniform-accel">
            <span>加速度 aₓ (m/s²)</span>
            <input type="range" id="ua-ax" min="-10" max="10" step="0.5" value="2" />
            <input type="number" id="ua-ax-num" min="-10" max="10" step="0.5" value="2" />
          </label>
          <label class="row" data-scope="collision-1d">
            <span>质量 m₁ (kg)</span>
            <input type="range" id="col-m1" min="0.5" max="10" step="0.5" value="2" />
            <input type="number" id="col-m1-num" min="0.5" max="10" step="0.5" value="2" />
          </label>
          <label class="row" data-scope="collision-1d">
            <span>质量 m₂ (kg)</span>
            <input type="range" id="col-m2" min="0.5" max="10" step="0.5" value="3" />
            <input type="number" id="col-m2-num" min="0.5" max="10" step="0.5" value="3" />
          </label>
          <label class="row" data-scope="collision-1d">
            <span>速度 v₁ (m/s)</span>
            <input type="range" id="col-v1" min="-15" max="15" step="0.5" value="5" />
            <input type="number" id="col-v1-num" min="-15" max="15" step="0.5" value="5" />
          </label>
          <label class="row" data-scope="collision-1d">
            <span>速度 v₂ (m/s)</span>
            <input type="range" id="col-v2" min="-15" max="15" step="0.5" value="-3" />
            <input type="number" id="col-v2-num" min="-15" max="15" step="0.5" value="-3" />
          </label>
          <label class="row" data-scope="collision-1d">
            <span>恢复系数 e</span>
            <input type="range" id="col-e" min="0" max="1" step="0.05" value="1" />
            <input type="number" id="col-e-num" min="0" max="1" step="0.05" value="1" />
          </label>
          <label class="row" data-scope="lever">
            <span>左侧力 F₁ (N)</span>
            <input type="range" id="lev-f1" min="0" max="50" step="1" value="20" />
            <input type="number" id="lev-f1-num" min="0" max="50" step="1" value="20" />
          </label>
          <label class="row" data-scope="lever">
            <span>左侧臂长 d₁ (m)</span>
            <input type="range" id="lev-d1" min="0" max="3" step="0.1" value="1.5" />
            <input type="number" id="lev-d1-num" min="0" max="3" step="0.1" value="1.5" />
          </label>
          <label class="row" data-scope="lever">
            <span>右侧力 F₂ (N)</span>
            <input type="range" id="lev-f2" min="0" max="50" step="1" value="20" />
            <input type="number" id="lev-f2-num" min="0" max="50" step="1" value="20" />
          </label>
          <label class="row" data-scope="lever">
            <span>右侧臂长 d₂ (m)</span>
            <input type="range" id="lev-d2" min="0" max="3" step="0.1" value="1.5" />
            <input type="number" id="lev-d2-num" min="0" max="3" step="0.1" value="1.5" />
          </label>
          <label class="row" data-scope="wave">
            <span>波长 λ (m)</span>
            <input type="range" id="wave-lambda" min="0.5" max="5" step="0.1" value="2" />
            <input type="number" id="wave-lambda-num" min="0.5" max="5" step="0.1" value="2" />
          </label>
          <label class="row" data-scope="wave">
            <span>频率 f (Hz)</span>
            <input type="range" id="wave-freq" min="0.1" max="3" step="0.1" value="1" />
            <input type="number" id="wave-freq-num" min="0.1" max="3" step="0.1" value="1" />
          </label>
          <label class="row" data-scope="wave">
            <span>振幅 A (m)</span>
            <input type="range" id="wave-amp" min="0.1" max="1.5" step="0.1" value="0.5" />
            <input type="number" id="wave-amp-num" min="0.1" max="1.5" step="0.1" value="0.5" />
          </label>
          
          <!-- 电场参数 -->
          <label class="row" data-scope="electric-field">
            <span>电荷量 q (μC)</span>
            <input type="range" id="em-charge" min="-10" max="10" step="0.5" value="1" />
            <input type="number" id="em-charge-num" min="-10" max="10" step="0.5" value="1" />
          </label>
          <label class="row" data-scope="electric-field">
            <span>粒子质量 m (×10⁻²⁷kg)</span>
            <input type="range" id="em-mass" min="1" max="100" step="1" value="1.67" />
            <input type="number" id="em-mass-num" min="1" max="100" step="1" value="1.67" />
          </label>
          <label class="row" data-scope="electric-field">
            <span>电场强度 E (N/C)</span>
            <input type="range" id="em-E" min="0" max="1000" step="10" value="500" />
            <input type="number" id="em-E-num" min="0" max="1000" step="10" value="500" />
          </label>
          <label class="row" data-scope="electric-field">
            <span>电场方向 (°)</span>
            <input type="range" id="em-E-angle" min="0" max="360" step="15" value="90" />
            <input type="number" id="em-E-angle-num" min="0" max="360" step="15" value="90" />
          </label>
          <label class="row" data-scope="electric-field">
            <span>初速度 v₀ (×10⁶m/s)</span>
            <input type="range" id="em-v0" min="0" max="10" step="0.5" value="2" />
            <input type="number" id="em-v0-num" min="0" max="10" step="0.5" value="2" />
          </label>
          <label class="row" data-scope="electric-field">
            <span>初速度方向 (°)</span>
            <input type="range" id="em-v0-angle" min="0" max="360" step="15" value="0" />
            <input type="number" id="em-v0-angle-num" min="0" max="360" step="15" value="0" />
          </label>
          
          <!-- 磁场参数 -->
          <label class="row" data-scope="magnetic-field">
            <span>电荷量 q (μC)</span>
            <input type="range" id="mag-charge" min="-10" max="10" step="0.5" value="1" />
            <input type="number" id="mag-charge-num" min="-10" max="10" step="0.5" value="1" />
          </label>
          <label class="row" data-scope="magnetic-field">
            <span>粒子质量 m (×10⁻²⁷kg)</span>
            <input type="range" id="mag-mass" min="1" max="100" step="1" value="1.67" />
            <input type="number" id="mag-mass-num" min="1" max="100" step="1" value="1.67" />
          </label>
          <label class="row" data-scope="magnetic-field">
            <span>磁感应强度 B (T)</span>
            <input type="range" id="mag-B" min="0.001" max="1" step="0.01" value="0.1" />
            <input type="number" id="mag-B-num" min="0.001" max="1" step="0.01" value="0.1" />
          </label>
          <label class="row" data-scope="magnetic-field">
            <span>磁场方向</span>
            <select id="mag-B-dir">
              <option value="in">垂直纸面向里 ⊗</option>
              <option value="out">垂直纸面向外 ⊙</option>
            </select>
          </label>
          <label class="row" data-scope="magnetic-field">
            <span>初速度 v₀ (×10⁶m/s)</span>
            <input type="range" id="mag-v0" min="0.1" max="10" step="0.1" value="2" />
            <input type="number" id="mag-v0-num" min="0.1" max="10" step="0.1" value="2" />
          </label>
          <label class="row" data-scope="magnetic-field">
            <span>初速度方向 (°)</span>
            <input type="range" id="mag-v0-angle" min="0" max="360" step="15" value="0" />
            <input type="number" id="mag-v0-angle-num" min="0" max="360" step="15" value="0" />
          </label>
          
          <!-- 电磁场组合参数 -->
          <label class="row" data-scope="em-field">
            <span>电荷量 q (μC)</span>
            <input type="range" id="emf-charge" min="-10" max="10" step="0.5" value="1" />
            <input type="number" id="emf-charge-num" min="-10" max="10" step="0.5" value="1" />
          </label>
          <label class="row" data-scope="em-field">
            <span>粒子质量 m (×10⁻²⁷kg)</span>
            <input type="range" id="emf-mass" min="1" max="100" step="1" value="1.67" />
            <input type="number" id="emf-mass-num" min="1" max="100" step="1" value="1.67" />
          </label>
          <label class="row" data-scope="em-field">
            <span>电场强度 E (N/C)</span>
            <input type="range" id="emf-E" min="0" max="1000" step="10" value="200" />
            <input type="number" id="emf-E-num" min="0" max="1000" step="10" value="200" />
          </label>
          <label class="row" data-scope="em-field">
            <span>电场方向 (°)</span>
            <input type="range" id="emf-E-angle" min="0" max="360" step="15" value="90" />
            <input type="number" id="emf-E-angle-num" min="0" max="360" step="15" value="90" />
          </label>
          <label class="row" data-scope="em-field">
            <span>磁感应强度 B (T)</span>
            <input type="range" id="emf-B" min="0.001" max="1" step="0.01" value="0.1" />
            <input type="number" id="emf-B-num" min="0.001" max="1" step="0.01" value="0.1" />
          </label>
          <label class="row" data-scope="em-field">
            <span>磁场方向</span>
            <select id="emf-B-dir">
              <option value="in">垂直纸面向里 ⊗</option>
              <option value="out">垂直纸面向外 ⊙</option>
            </select>
          </label>
          <label class="row" data-scope="em-field">
            <span>初速度 v₀ (×10⁶m/s)</span>
            <input type="range" id="emf-v0" min="0" max="10" step="0.5" value="2" />
            <input type="number" id="emf-v0-num" min="0" max="10" step="0.5" value="2" />
          </label>
          <label class="row" data-scope="em-field">
            <span>初速度方向 (°)</span>
            <input type="range" id="emf-v0-angle" min="0" max="360" step="15" value="0" />
            <input type="number" id="emf-v0-angle-num" min="0" max="360" step="15" value="0" />
          </label>
          
          <!-- 场区域设置 -->
          <label class="row" data-scope="electric-field">
            <span>场区域 X起点 (m)</span>
            <input type="range" id="em-field-x" min="-5" max="10" step="0.5" value="-2" />
            <input type="number" id="em-field-x-num" min="-5" max="10" step="0.5" value="-2" />
          </label>
          <label class="row" data-scope="electric-field">
            <span>场区域宽度 (m)</span>
            <input type="range" id="em-field-w" min="5" max="30" step="0.5" value="28" />
            <input type="number" id="em-field-w-num" min="5" max="30" step="0.5" value="28" />
          </label>
          <label class="row" data-scope="electric-field">
            <span>场区域 Y起点 (m)</span>
            <input type="range" id="em-field-y" min="-10" max="5" step="0.5" value="-6" />
            <input type="number" id="em-field-y-num" min="-10" max="5" step="0.5" value="-6" />
          </label>
          <label class="row" data-scope="electric-field">
            <span>场区域高度 (m)</span>
            <input type="range" id="em-field-h" min="5" max="20" step="0.5" value="18" />
            <input type="number" id="em-field-h-num" min="5" max="20" step="0.5" value="18" />
          </label>
          
          <label class="row" data-scope="magnetic-field">
            <span>场区域 X起点 (m)</span>
            <input type="range" id="mag-field-x" min="-5" max="10" step="0.5" value="-2" />
            <input type="number" id="mag-field-x-num" min="-5" max="10" step="0.5" value="-2" />
          </label>
          <label class="row" data-scope="magnetic-field">
            <span>场区域宽度 (m)</span>
            <input type="range" id="mag-field-w" min="5" max="30" step="0.5" value="28" />
            <input type="number" id="mag-field-w-num" min="5" max="30" step="0.5" value="28" />
          </label>
          <label class="row" data-scope="magnetic-field">
            <span>场区域 Y起点 (m)</span>
            <input type="range" id="mag-field-y" min="-10" max="5" step="0.5" value="-6" />
            <input type="number" id="mag-field-y-num" min="-10" max="5" step="0.5" value="-6" />
          </label>
          <label class="row" data-scope="magnetic-field">
            <span>场区域高度 (m)</span>
            <input type="range" id="mag-field-h" min="5" max="20" step="0.5" value="18" />
            <input type="number" id="mag-field-h-num" min="5" max="20" step="0.5" value="18" />
          </label>
          
          <label class="row" data-scope="em-field">
            <span>场区域 X起点 (m)</span>
            <input type="range" id="emf-field-x" min="-5" max="10" step="0.5" value="-2" />
            <input type="number" id="emf-field-x-num" min="-5" max="10" step="0.5" value="-2" />
          </label>
          <label class="row" data-scope="em-field">
            <span>场区域宽度 (m)</span>
            <input type="range" id="emf-field-w" min="5" max="30" step="0.5" value="28" />
            <input type="number" id="emf-field-w-num" min="5" max="30" step="0.5" value="28" />
          </label>
          <label class="row" data-scope="em-field">
            <span>场区域 Y起点 (m)</span>
            <input type="range" id="emf-field-y" min="-10" max="5" step="0.5" value="-6" />
            <input type="number" id="emf-field-y-num" min="-10" max="5" step="0.5" value="-6" />
          </label>
          <label class="row" data-scope="em-field">
            <span>场区域高度 (m)</span>
            <input type="range" id="emf-field-h" min="5" max="20" step="0.5" value="18" />
            <input type="number" id="emf-field-h-num" min="5" max="20" step="0.5" value="18" />
          </label>
        </div>

        <div class="panel">
          <div class="panel-title">环境参数 <i class="fas fa-cog" title="高级设置"></i></div>
          <div class="physics-group active">
            <label class="row">
              <span>重力 g (m/s²)</span>
              <input type="range" id="gravity" min="0" max="20" step="0.1" value="9.8" />
              <input type="number" id="gravity-num" min="0" max="20" step="0.1" value="9.8" />
            </label>
            <label class="row" data-scope="projectile">
              <span>空气阻力系数 C</span>
              <input type="range" id="drag" min="0" max="0.2" step="0.005" value="0.02" />
              <input type="number" id="drag-num" min="0" max="0.2" step="0.005" value="0.02" />
            </label>
            <label class="row">
              <span>时间倍率</span>
              <input type="range" id="time-scale" min="0.2" max="2" step="0.1" value="1" />
              <input type="number" id="time-scale-num" min="0.2" max="2" step="0.1" value="1" />
            </label>
          </div>
        </div>

        <div class="panel">
          <div class="panel-title">显示</div>
          <label class="row small">
            <span>显示速度矢量</span>
            <input type="checkbox" id="show-vel" checked />
          </label>
          <label class="row small">
            <span>显示加速度矢量</span>
            <input type="checkbox" id="show-acc" checked />
          </label>
          <label class="row small">
            <span>显示轨迹</span>
            <input type="checkbox" id="show-trace" checked />
          </label>
          <label class="row small">
            <span>显示网格</span>
            <input type="checkbox" id="show-grid" checked />
          </label>
          <div class="row">
            <button id="btn-clear-trace">清除轨迹</button>
          </div>
        </div>

        <div class="panel">
          <div class="panel-title">多球交互</div>
          <div class="row small">
            <button id="btn-add-ball">添加小球（点击画布放置）</button>
          </div>
          <div class="row small">
            <button id="btn-clear-balls">清空小球</button>
          </div>
          <div class="footnote">
            操作说明：<br>
            1. 点击"添加小球"，然后在画布上点击放置位置<br>
            2. 点击任意小球可选择并编辑其参数<br>
            3. 可独立调整每个小球的位置、速度、质量等
          </div>
        </div>

        <div class="panel" id="ball-edit-panel" style="display: none;">
          <div class="panel-title">编辑选中小球</div>
          <div class="row" data-param="motion">
            <label>运动类型</label>
            <select id="ball-motion-type">
              <option value="projectile">抛体运动</option>
              <option value="freefall">自由落体</option>
              <option value="spring">弹簧振动</option>
              <option value="uniform">匀速运动</option>
              <option value="uniform-accel">匀加速运动</option>
              <option value="static">静止</option>
            </select>
          </div>
          <div class="row" data-param="pos">
            <label>位置 (x, y) (m)</label>
            <input type="number" id="ball-x" step="0.1" value="0">
            <input type="number" id="ball-y" step="0.1" value="0">
          </div>
          <div class="row" data-param="vel">
            <label>速度 (vₓ, vᵧ) (m/s)</label>
            <input type="number" id="ball-vx" step="0.1" value="0">
            <input type="number" id="ball-vy" step="0.1" value="0">
          </div>
          <div class="row" data-param="mass">
            <label>质量 m (kg)</label>
            <input type="range" id="ball-mass" min="0.1" max="10" step="0.1" value="1">
            <output id="ball-mass-val">1.0</output>
            <input type="number" id="ball-mass-num" min="0.1" max="10" step="0.1" value="1">
          </div>
          <div class="row" data-param="v0">
            <label>初速度 v0 (m/s)</label>
            <input type="range" id="ball-v0" min="0" max="50" step="1" value="20">
            <output id="ball-v0-val">20</output>
            <input type="number" id="ball-v0-num" min="0" max="50" step="1" value="20">
          </div>
          <div class="row" data-param="angle">
            <label>发射角 θ (°)</label>
            <input type="range" id="ball-angle" min="0" max="90" step="1" value="45">
            <output id="ball-angle-val">45</output>
            <input type="number" id="ball-angle-num" min="0" max="90" step="1" value="45">
          </div>
          <div class="row" data-param="physics" id="ball-physics-params">
            <div class="physics-group" data-motion="projectile,freefall">
              <label>重力 g (m/s²)</label>
              <input type="number" id="ball-gravity" step="0.1" value="9.8" min="0" max="20">
            </div>
            <div class="physics-group" data-motion="projectile,spring">
              <label>阻力系数 C</label>
              <input type="number" id="ball-drag" step="0.001" value="0.02" min="0" max="1">
            </div>
            <div class="physics-group" data-motion="spring">
              <label>弹簧刚度 k (N/m)</label>
              <input type="number" id="ball-spring-k" step="1" value="50" min="1" max="200">
            </div>
            <div class="physics-group" data-motion="spring">
              <label>阻尼 b (kg/s)</label>
              <input type="number" id="ball-damping" step="0.1" value="0.5" min="0" max="5">
            </div>
            <div class="physics-group" data-motion="uniform-accel">
              <label>加速度 a (m/s²)</label>
              <input type="number" id="ball-accel" step="0.1" value="2" min="-10" max="10">
            </div>
          </div>
          <div class="row small">
            <button id="btn-apply-ball-params">应用参数</button>
            <button id="btn-reset-ball-motion">重置运动</button>
          </div>
        </div>

        <div class="panel">
          <div class="panel-title">数据 / 计算（实时）</div>
          <div class="row small"><span>时间 t (s)</span><span id="stat-t">0.00</span></div>
          <div class="row small"><span>位置 (x, y) (m)</span><span id="stat-pos">(0.00, 0.00)</span></div>
          <div class="row small"><span>速度 (vₓ, vᵧ) (m/s)</span><span id="stat-vel">(0.00, 0.00)</span></div>
          <div class="row small"><span>加速度 (aₓ, aᵧ) (m/s²)</span><span id="stat-acc">(0.00, 0.00)</span></div>
          <div class="row small"><span>|v| / |a|</span><span id="stat-mag">0.00 / 0.00</span></div>
          <div class="row small"><span>动能 Ek (J)</span><span id="stat-ek">0.00</span></div>
          <div class="row small"><span>势能 Ep (J)</span><span id="stat-ep">0.00</span></div>
          <div class="row small"><span>机械能 Em (J)</span><span id="stat-em">0.00</span></div>
          <div class="row small" data-scope="collision-1d"><span>碰撞 p 总 (kg·m/s)</span><span id="stat-p">0.00</span></div>
        </div>

        <div class="panel footnote">
          小贴士：可通过调节 g、空气阻力、弹簧刚度/阻尼，观察轨迹、速度与加速度随时间的变化。
        </div>
      </aside>
    </main>

    <div class="tabs">
      <button class="tab-btn active" data-tab="simulation">模拟</button>
      <button class="tab-btn" data-tab="formulas">公式速查</button>
      <button class="tab-btn" data-tab="practice">练习题</button>
      <button class="tab-btn" data-tab="settings">设置</button>
    </div>

    <div id="formulas-tab" class="tab-content" style="display: none;">
      <h3>高中物理公式速查</h3>
      
      <div class="formula-section">
        <h4>一、运动学公式</h4>
        <div class="formula-grid">
          <div class="formula-card">
            <div class="formula">v = v₀ + at</div>
            <div class="formula-desc">速度公式</div>
          </div>
          <div class="formula-card">
            <div class="formula">s = v₀t + ½at²</div>
            <div class="formula-desc">位移公式</div>
          </div>
          <div class="formula-card">
            <div class="formula">v² - v₀² = 2as</div>
            <div class="formula-desc">速度位移关系式</div>
          </div>
          <div class="formula-card">
            <div class="formula">s = (v₀+v)/2 · t</div>
            <div class="formula-desc">平均速度公式</div>
          </div>
        </div>
      </div>
      
      <div class="formula-section">
        <h4>二、力学公式</h4>
        <div class="formula-grid">
          <div class="formula-card">
            <div class="formula">F = ma</div>
            <div class="formula-desc">牛顿第二定律</div>
          </div>
          <div class="formula-card">
            <div class="formula">F = kx</div>
            <div class="formula-desc">胡克定律</div>
          </div>
          <div class="formula-card">
            <div class="formula">f = μN</div>
            <div class="formula-desc">滑动摩擦力</div>
          </div>
          <div class="formula-card">
            <div class="formula">G = mg</div>
            <div class="formula-desc">重力公式</div>
          </div>
        </div>
      </div>
      
      <div class="formula-section">
        <h4>三、圆周运动</h4>
        <div class="formula-grid">
          <div class="formula-card">
            <div class="formula">a = v²/r = ω²r</div>
            <div class="formula-desc">向心加速度</div>
          </div>
          <div class="formula-card">
            <div class="formula">F = mv²/r = mω²r</div>
            <div class="formula-desc">向心力公式</div>
          </div>
          <div class="formula-card">
            <div class="formula">v = ωr = 2πr/T</div>
            <div class="formula-desc">线速度公式</div>
          </div>
          <div class="formula-card">
            <div class="formula">T = 2π/ω</div>
            <div class="formula-desc">周期公式</div>
          </div>
        </div>
      </div>
      
      <div class="formula-section">
        <h4>四、能量与动量</h4>
        <div class="formula-grid">
          <div class="formula-card">
            <div class="formula">Ek = ½mv²</div>
            <div class="formula-desc">动能</div>
          </div>
          <div class="formula-card">
            <div class="formula">Ep = mgh</div>
            <div class="formula-desc">重力势能</div>
          </div>
          <div class="formula-card">
            <div class="formula">p = mv</div>
            <div class="formula-desc">动量公式</div>
          </div>
          <div class="formula-card">
            <div class="formula">I = Ft</div>
            <div class="formula-desc">冲量公式</div>
          </div>
        </div>
      </div>
      
      <div class="formula-section">
        <h4>五、振动与波动</h4>
        <div class="formula-grid">
          <div class="formula-card">
            <div class="formula">T = 2π√(m/k)</div>
            <div class="formula-desc">弹簧振子周期</div>
          </div>
          <div class="formula-card">
            <div class="formula">T = 2π√(L/g)</div>
            <div class="formula-desc">单摆周期</div>
          </div>
          <div class="formula-card">
            <div class="formula">v = λf</div>
            <div class="formula-desc">波速公式</div>
          </div>
          <div class="formula-card">
            <div class="formula">λ = vT</div>
            <div class="formula-desc">波长公式</div>
          </div>
        </div>
      </div>
      
      <div class="formula-section">
        <h4>六、电场</h4>
        <div class="formula-grid">
          <div class="formula-card">
            <div class="formula">F = kq₁q₂/r²</div>
            <div class="formula-desc">库仑定律</div>
          </div>
          <div class="formula-card">
            <div class="formula">E = F/q = kQ/r²</div>
            <div class="formula-desc">电场强度</div>
          </div>
          <div class="formula-card">
            <div class="formula">U = Ed</div>
            <div class="formula-desc">匀强电场电势差</div>
          </div>
          <div class="formula-card">
            <div class="formula">W = qU</div>
            <div class="formula-desc">电场力做功</div>
          </div>
        </div>
      </div>
      
      <div class="formula-section">
        <h4>七、磁场</h4>
        <div class="formula-grid">
          <div class="formula-card">
            <div class="formula">F = qvB</div>
            <div class="formula-desc">洛伦兹力</div>
          </div>
          <div class="formula-card">
            <div class="formula">r = mv/qB</div>
            <div class="formula-desc">回旋半径</div>
          </div>
          <div class="formula-card">
            <div class="formula">T = 2πm/qB</div>
            <div class="formula-desc">回旋周期</div>
          </div>
          <div class="formula-card">
            <div class="formula">F = BIL</div>
            <div class="formula-desc">安培力</div>
          </div>
        </div>
      </div>
      
      <div class="formula-section">
        <h4>八、电磁感应</h4>
        <div class="formula-grid">
          <div class="formula-card">
            <div class="formula">ε = BLv</div>
            <div class="formula-desc">动生电动势</div>
          </div>
          <div class="formula-card">
            <div class="formula">ε = -dΦ/dt</div>
            <div class="formula-desc">法拉第电磁感应定律</div>
          </div>
          <div class="formula-card">
            <div class="formula">Φ = BS</div>
            <div class="formula-desc">磁通量</div>
          </div>
          <div class="formula-card">
            <div class="formula">ε = nΔΦ/Δt</div>
            <div class="formula-desc">感应电动势</div>
          </div>
        </div>
      </div>
    </div>

    <div id="practice-tab" class="tab-content" style="display: none;">
      <h3>练习题库</h3>
      <div class="question-nav">
        <button class="nav-btn active" data-question="1">题目1</button>
        <button class="nav-btn" data-question="2">题目2</button>
        <button class="nav-btn" data-question="3">题目3</button>
        <button class="nav-btn" data-question="4">题目4</button>
        <button class="nav-btn" data-question="5">题目5</button>
        <button class="nav-btn" data-question="6">题目6</button>
        <button class="nav-btn" data-question="7">题目7</button>
        <button class="nav-btn" data-question="8">题目8</button>
      </div>
      
      <div class="question active" data-q="1">
        <div class="question-tag">自由落体</div>
        <p>一个物体从高度为h处自由落下，求落地时的速度大小。</p>
        <div class="options">
          <label><input type="radio" name="q1" value="A"> A. √(gh)</label>
          <label><input type="radio" name="q1" value="B"> B. √(2gh)</label>
          <label><input type="radio" name="q1" value="C"> C. 2gh</label>
          <label><input type="radio" name="q1" value="D"> D. gh</label>
        </div>
        <button class="btn-check-answer" data-answer="B">检查答案</button>
        <div class="answer-explanation">
          <p><strong>正确答案：B</strong></p>
          <p>解析：根据机械能守恒定律，mgh = ½mv²，解得 v = √(2gh)</p>
        </div>
      </div>
      
      <div class="question" data-q="2">
        <div class="question-tag">抛体运动</div>
        <p>以20m/s的初速度水平抛出一个物体，2s后物体的速度大小约为（g=10m/s²）：</p>
        <div class="options">
          <label><input type="radio" name="q2" value="A"> A. 20m/s</label>
          <label><input type="radio" name="q2" value="B"> B. 28m/s</label>
          <label><input type="radio" name="q2" value="C"> C. 40m/s</label>
          <label><input type="radio" name="q2" value="D"> D. 44m/s</label>
        </div>
        <button class="btn-check-answer" data-answer="B">检查答案</button>
        <div class="answer-explanation">
          <p><strong>正确答案：B</strong></p>
          <p>解析：水平速度vₓ=20m/s，竖直速度vy=gt=20m/s，合速度v=√(vₓ²+vy²)=√(400+400)=20√2≈28m/s</p>
        </div>
      </div>
      
      <div class="question" data-q="3">
        <div class="question-tag">圆周运动</div>
        <p>一个物体做匀速圆周运动，半径为2m，角速度为3rad/s，则向心加速度为：</p>
        <div class="options">
          <label><input type="radio" name="q3" value="A"> A. 6m/s²</label>
          <label><input type="radio" name="q3" value="B"> B. 9m/s²</label>
          <label><input type="radio" name="q3" value="C"> C. 12m/s²</label>
          <label><input type="radio" name="q3" value="D"> D. 18m/s²</label>
        </div>
        <button class="btn-check-answer" data-answer="D">检查答案</button>
        <div class="answer-explanation">
          <p><strong>正确答案：D</strong></p>
          <p>解析：根据向心加速度公式 a=ω²r=3²×2=18m/s²</p>
        </div>
      </div>
      
      <div class="question" data-q="4">
        <div class="question-tag">弹簧振子</div>
        <p>一个弹簧振子，弹簧劲度系数k=100N/m，振子质量m=1kg，则振动周期为：</p>
        <div class="options">
          <label><input type="radio" name="q4" value="A"> A. 0.2πs</label>
          <label><input type="radio" name="q4" value="B"> B. 0.5πs</label>
          <label><input type="radio" name="q4" value="C"> C. πs</label>
          <label><input type="radio" name="q4" value="D"> D. 2πs</label>
        </div>
        <button class="btn-check-answer" data-answer="A">检查答案</button>
        <div class="answer-explanation">
          <p><strong>正确答案：A</strong></p>
          <p>解析：根据弹簧振子周期公式 T=2π√(m/k)=2π√(1/100)=2π×0.1=0.2πs</p>
        </div>
      </div>
      
      <div class="question" data-q="5">
        <div class="question-tag">碰撞</div>
        <p>质量为2kg的小球以4m/s的速度与静止的3kg小球发生正碰，若碰撞是完全弹性的，碰后2kg小球的速度为：</p>
        <div class="options">
          <label><input type="radio" name="q5" value="A"> A. -0.8m/s</label>
          <label><input type="radio" name="q5" value="B"> B. 0.8m/s</label>
          <label><input type="radio" name="q5" value="C"> C. 1.6m/s</label>
          <label><input type="radio" name="q5" value="D"> D. -1.6m/s</label>
        </div>
        <button class="btn-check-answer" data-answer="A">检查答案</button>
        <div class="answer-explanation">
          <p><strong>正确答案：A</strong></p>
          <p>解析：完全弹性碰撞公式 v₁'=(m₁-m₂)v₁/(m₁+m₂)=(2-3)×4/5=-0.8m/s，负号表示反向运动</p>
        </div>
      </div>
      
      <div class="question" data-q="6">
        <div class="question-tag">电场</div>
        <p>一个电子（电荷量e=1.6×10⁻¹⁹C）在电场强度E=1000N/C的匀强电场中，所受电场力大小为：</p>
        <div class="options">
          <label><input type="radio" name="q6" value="A"> A. 1.6×10⁻¹⁹N</label>
          <label><input type="radio" name="q6" value="B"> B. 1.6×10⁻¹⁶N</label>
          <label><input type="radio" name="q6" value="C"> C. 1.6×10⁻²²N</label>
          <label><input type="radio" name="q6" value="D"> D. 1.6×10⁻¹³N</label>
        </div>
        <button class="btn-check-answer" data-answer="B">检查答案</button>
        <div class="answer-explanation">
          <p><strong>正确答案：B</strong></p>
          <p>解析：电场力F=qE=1.6×10⁻¹⁹×1000=1.6×10⁻¹⁶N</p>
        </div>
      </div>
      
      <div class="question" data-q="7">
        <div class="question-tag">磁场</div>
        <p>一个质子（m=1.67×10⁻²⁷kg，q=1.6×10⁻¹⁹C）以2×10⁶m/s的速度垂直进入磁感应强度B=0.1T的匀强磁场，其圆周运动的半径为：</p>
        <div class="options">
          <label><input type="radio" name="q7" value="A"> A. 0.21m</label>
          <label><input type="radio" name="q7" value="B"> B. 0.021m</label>
          <label><input type="radio" name="q7" value="C"> C. 2.1m</label>
          <label><input type="radio" name="q7" value="D"> D. 0.0021m</label>
        </div>
        <button class="btn-check-answer" data-answer="A">检查答案</button>
        <div class="answer-explanation">
          <p><strong>正确答案：A</strong></p>
          <p>解析：回旋半径r=mv/qB=(1.67×10⁻²⁷×2×10⁶)/(1.6×10⁻¹⁹×0.1)≈0.21m</p>
        </div>
      </div>
      
      <div class="question" data-q="8">
        <div class="question-tag">电磁场</div>
        <p>在速度选择器中，电场强度E=2×10⁴N/C，磁感应强度B=0.1T，能够直线通过的带电粒子速度为：</p>
        <div class="options">
          <label><input type="radio" name="q8" value="A"> A. 2×10³m/s</label>
          <label><input type="radio" name="q8" value="B"> B. 2×10⁴m/s</label>
          <label><input type="radio" name="q8" value="C"> C. 2×10⁵m/s</label>
          <label><input type="radio" name="q8" value="D"> D. 2×10⁶m/s</label>
        </div>
        <button class="btn-check-answer" data-answer="C">检查答案</button>
        <div class="answer-explanation">
          <p><strong>正确答案：C</strong></p>
          <p>解析：速度选择器原理是电场力和洛伦兹力平衡，即qE=qvB，解得v=E/B=2×10⁴/0.1=2×10⁵m/s</p>
        </div>
      </div>
    </div>

    <div id="settings-tab" class="tab-content" style="display: none;">
      <h3>设置</h3>
      <div class="setting-option">
        <label>
          <input type="checkbox" id="dark-mode"> 深色模式
        </label>
      </div>
      <div class="setting-option">
        <label>显示轨迹
          <input type="checkbox" id="show-trajectory" checked>
        </label>
      </div>
      <div class="setting-option">
        <label>显示受力分析
          <input type="checkbox" id="show-forces" checked>
        </label>
      </div>
      <div class="setting-option">
        <label>显示能量条
          <input type="checkbox" id="show-energy" checked>
        </label>
      </div>
    </div>

    <footer class="app-footer">
      <div class="footer-content">
        <div class="footer-left">
          <span id="simulation-time">时间: 0.00s</span>
          <span id="simulation-fps">FPS: 60</span>
        </div>
        <div class="footer-center">
          © 2025 物理教学演示 | 仅用于课堂演示与学习
        </div>
        <div class="footer-right">
          <button id="btn-help" title="帮助"><i class="fas fa-question-circle"></i></button>
          <button id="btn-fullscreen" title="全屏"><i class="fas fa-expand"></i></button>
        </div>
      </div>
    </footer>

    <script defer src="./js/bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="./js/enhancements.js"></script>
  </body>
  </html>


